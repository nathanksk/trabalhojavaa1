from datetime import datetime

class Fornecedor:
    def __init__(self, id, nome, contato):
        self.id = id
        self.nome = nome
        self.contato = contato

    def __str__(self):
        return f"{self.nome} (Contato: {self.contato})"


class Produto:
    def __init__(self, id, nome, quantidade, preco, fornecedor):
        self.id = id
        self.nome = nome
        self.quantidade = quantidade
        self.preco = preco
        self.fornecedor = fornecedor

    def repor_estoque(self, qtd):
        self.quantidade += qtd

    def baixar_estoque(self, qtd):
        if qtd <= self.quantidade:
            self.quantidade -= qtd
        else:
            print(f"Estoque insuficiente para {self.nome}!")

    def __str__(self):
        return f"{self.nome} - Qtd: {self.quantidade} - Preço: R${self.preco:.2f}"


class Pedido:
    def __init__(self, id, produto, fornecedor, quantidade):
        self.id = id
        self.produto = produto
        self.fornecedor = fornecedor
        self.quantidade = quantidade
        self.data = datetime.now()

    def realizar_pedido(self):
        self.produto.repor_estoque(self.quantidade)
        print(f"Pedido realizado: {self.quantidade}x {self.produto.nome} de {self.fornecedor.nome}")


class Estoque:
    def __init__(self):
        self.produtos = []
        self.pedidos = []

    def adicionar_produto(self, produto):
        self.produtos.append(produto)

    def listar_produtos(self):
        print("\n📦 Produtos em Estoque:")
        for p in self.produtos:
            print(p)

    def listar_estoque_baixo(self, limite=10):
        print(f"\n🔻 Produtos com estoque abaixo de {limite}:")
        for p in self.produtos:
            if p.quantidade < limite:
                print(p)

    def fazer_pedido(self, produto_id, quantidade):
        for produto in self.produtos:
            if produto.id == produto_id:
                pedido = Pedido(len(self.pedidos) + 1, produto, produto.fornecedor, quantidade)
                pedido.realizar_pedido()
                self.pedidos.append(pedido)
                return
        print("❌ Produto não encontrado!")


# === Demonstração ===
if __name__ == "__main__":
    # Criar fornecedores
    fornecedor1 = Fornecedor(1, "Fornecedor A", "contato@a.com")
    fornecedor2 = Fornecedor(2, "Fornecedor B", "contato@b.com")

    # Criar produtos
    produto1 = Produto(1, "Teclado", 5, 120.00, fornecedor1)
    produto2 = Produto(2, "Mouse", 15, 60.00, fornecedor1)
    produto3 = Produto(3, "Monitor", 2, 900.00, fornecedor2)

    # Criar estoque
    estoque = Estoque()
    estoque.adicionar_produto(produto1)
    estoque.adicionar_produto(produto2)
    estoque.adicionar_produto(produto3)

    # Listar todos os produtos
    estoque.listar_produtos()

    # Listar produtos com estoque baixo (<10)
    estoque.listar_estoque_baixo()

    # Fazer um pedido para repor estoque
    estoque.fazer_pedido(produto_id=1, quantidade=20)

    # Ver estoque atualizado
    estoque.listar_produtos()
